rsync 快速 多功能 远程（本地） 文件拷贝 系统

语法

本地：
	rsync [OPTION...] <源数据> [目标路径]

从远程 shell 使用：
	拉取：
		rsync [OPTION...] [<用户名>@]<远程主机>:<源数据>... [目标路径]
	推送：
		rsync [OPTION...] <源数据>... [<用户>@]<远程主机>:<目标路径>

从 rsync 服务使用：
	拉取：
		rsync [OPTION...] [<用户>@]<远程主机>::<源数据>... [目标路径]
		rsync [OPTION...] rsync://[<用户>@]<远程主机>[:<端口>]/<源数据>... [目标路径]
	推送：
		rsync [OPTION...] <源数据>... [<用户>@]<远程主机>::<目标路径>
		rsync [OPTION...] <源数据> rsync://[<用户>@]<远程主机>[:<端口>]/<目标路径>


大体说明

rsync 支持 本地 与 本地 对拷、本地 与 远程 对拷，但不支持 远程 与 远程 对拷

rysnc 支持两种方式连接 远程系统：
	一种是用过连接 远程 shell（remote-shell） 作为通道（比如 ssh 或 rsh）
	或直接通过 TCP 连接至 rsync 服务

	当使用 单个冒号 : 区分 主机 和 路径时，表示使用 远程 shell
	当使用 双冒号 :: 区分 主机 和 路径时，表示使用 rsync 服务

如果仅指定 源路径 而不指定其他的内容，则罗列 源路径 下的文件，输出形式和 ls -l 类似

rsync 将 本地 视为 client，将 远程 视为 server
rsync daemon 一定是一个 server


安装

rsync 必须在 本地 及 远程 机器上安装才可以正常使用

默认情况下， rsync 通过 ssh 作为通信用的 远程 shell
这个设置可以通过选项 -e 或 环境变量 RSYNC_RSH 指定


用法

保持原有修改时间不变

	rsync -t *.c foo:src/

以 存档 的方式备份数据，并在传输之前进行压缩处理，以减少传输量

	rsync -avz foo:src/bar/ /data/tmp

若 源数据 以 / 作为结尾，则拷贝 文件夹的内容 至新目录
若 源数据 以 文件夹名 作为结尾，则在新目录下创建 文件夹，再拷贝 文件夹的内容
以下两种写法是等价的

	rsync -av /src/foo /dest
	rsync -av /src/foo/ /dest/foo

当使用 rsync daemon 时，daemon 会定义一些模块（module），
模块的配置文件 会指定 该模块可以使用的顶层目录路径 等等信息
此时， rsync 标识路径就写为

rsync -av <主机名>::<模块名>/<相对模块路径> <目标路径>

用以下命令罗列主机可使用的所有模块

rsync <主机名>::


选项

-v, --verbose
	详细模式，多个 -v 连用时，会逐步增加详细度

-q, --quiet
	静默模式，这会减少屏显输出量

--no-motd
	不显示 message-of-the-day

-I, --ignore-time
	通常来说 rsync 在文件覆盖检查时，会跳过拷贝前后 大小 和 修改时间 都一致的文件
	这个选项会关闭这个 比较 操作，让所有的文件都得到更新

--size-only
	仅以文件大小的改变作为是否开启传输的判断依据，忽略 修改时间 的影响

--modify-window
	若新旧两个文件的 修改时间 之差 在 modify-window 所定义的时间之内
	rsync 就认为这个文件的 修改时间 是一致的
	一般情况下，这个参数的大小是 0，也就是完全匹配
	但如果是与 MS Windows FAT 文件系统对拷数据，
	由于 FAT 文件系统的时间戳最小单位是 2 秒，所以 这个选项设置为 1 比较合适

-c, --checksum
	这个选项会修改 一个文件是否要被更新
	当使用这个选项时，
	若新旧文件的大小相同，rsync 会使用一个 128 位的 校验和 来确认文件 是否真的被修改过
	这个过程将消耗较多的 磁盘 IO 从而拖慢拷贝速度

	文件发送端 将在 扫描文件系统时建立 校验和列表，而文件接收端 将在 文件大小相同时 建立 文件校验和
	若两个校验和不同，则也会拷贝文件

	注意！在每个文件拷贝结束之后， rsync 会自动通过 文件校验和 来检查 文件拷贝是否完整，
	这个自动的操作和 -c 这个选项没有任何关系

	在较旧的 rsync 软件版本中（3.0.0之前），校验和使用的是 MD4，在较新的版本中（3.0.0及之后），使用的是 MD5

-a, --archive
	等价于 -rlptgoD，用于快速表明需要保留几乎所有的原始信息（除了 -H 所指定的内容）
	注意， -a 不保留 硬链接，因为寻找 多链接文件（multiply-linked files）是开销巨大的
	如果一定要保留原始的 硬链接 状态，请使用 -H 指令


--no-[选项]
	用 --no- 连上其他的选项表示 不要使用这个选项

	如果要使用 -a 但又不想使用内含的 -o，可以这么用
	-a --no-o
	注意， --no-o 一定要放置在 -a 之后
